const dadosLiterarios = {
  "autores": [
    {
      "id": 1,
      "nome": "Machado de Assis",
      "nacionalidade": "Brasileiro",
      "data_nascimento": "21/06/1839",
      "genero_escrita": "Romance realista, conto, crônica",
      "cidade_nascimento": "Rio de Janeiro",
      "estado_nascimento": "RJ",
      "img": "img/machado.png",
      "biografia": "Considerado um dos maiores escritores da literatura brasileira, fundador da Academia Brasileira de Letras.",
      "destaque": true,
      "obras": [
        {
          "id": 101,
          "titulo": "Dom Casmurro",
          "ano_publicacao": "1899",
          "img": "img/domcasmurro.jpg",
          "sinopse": "Bentinho narra sua história marcada por ciúmes e dúvidas sobre a fidelidade de Capitu.",
          "personagens_principais": ["Bentinho", "Capitu", "Escobar"]
        },
        {
          "id": 102,
          "titulo": "Memórias Póstumas de Brás Cubas",
          "ano_publicacao": "1881",
          "img": "img/brascubas.jpg",
          "sinopse": "Narrado por um defunto, o livro é uma crítica irônica à sociedade do século XIX.",
          "personagens_principais": ["Brás Cubas", "Quincas Borba", "Virgília"]
        }
      ]
    },
    {
      "id": 2,
      "nome": "Clarice Lispector",
      "nacionalidade": "Brasileira",
      "data_nascimento": "10/12/1920",
      "genero_escrita": "Romance introspectivo, conto",
      "cidade_nascimento": "Chechelnyk",
      "estado_nascimento": "Ucrânia (naturalizada brasileira)",
      "img": "img/clarice.jpg",
      "biografia": "Autora de obras introspectivas e poéticas, é uma das vozes mais marcantes da literatura brasileira moderna.",
      "destaque": true,
      "obras": [
        {
          "id": 201,
          "titulo": "A Hora da Estrela",
          "ano_publicacao": "1977",
          "img": "img/estrela.jpg",
          "sinopse": "A história de Macabéa, uma jovem nordestina que vive no Rio de Janeiro, contada com lirismo e crítica social.",
          "personagens_principais": ["Macabéa", "Rodrigo S.M.", "Olímpico de Jesus", "Glória"]
        },
        {
          "id": 202,
          "titulo": "Perto do Coração Selvagem",
          "ano_publicacao": "1943",
          "img": "img/perto.jpg",
          "sinopse": "Romance de estreia que revela a complexidade emocional e filosófica da protagonista Joana.",
          "personagens_principais": ["Joana"]
        }
      ]
    },
    {
      "id": 3,
      "nome": "Graciliano Ramos",
      "nacionalidade": "Brasileiro",
      "data_nascimento": "27/10/1892",
      "genero_escrita": "Romance regionalista, realismo social",
      "cidade_nascimento": "Quebrangulo",
      "estado_nascimento": "AL",
      "img": "img/graciliano.jpg",
      "biografia": "Reconhecido por sua escrita seca e direta, retratou a vida no sertão nordestino com profundidade e realismo.",
      "destaque": true,
      "obras": [
        {
          "id": 301,
          "titulo": "Vidas Secas",
          "ano_publicacao": "1938",
          "img": "img/vidassecas.jpg",
          "sinopse": "A saga de uma família sertaneja em busca de sobrevivência, marcada pela seca e pela miséria.",
          "personagens_principais": ["Fabiano", "Sinhá Vitória", "Baleia"]
        },
        {
          "id": 302,
          "titulo": "São Bernardo",
          "ano_publicacao": "1934",
          "img": "img/saobernardo.jpg",
          "sinopse": "A trajetória de Paulo Honório, um homem ambicioso que narra sua ascensão e queda pessoal.",
          "personagens_principais": ["Paulo Honório", "Madalena"]
        }
      ]
    },
    {
      "id": 4,
      "nome": "Jorge Amado",
      "nacionalidade": "Brasileiro",
      "data_nascimento": "10/08/1912",
      "genero_escrita": "Romance regionalista, realismo mágico",
      "cidade_nascimento": "Itabuna",
      "estado_nascimento": "BA",
      "img": "img/jorge.jpg",
      "biografia": "Um dos autores mais populares do Brasil, retratou com humor e crítica social a vida na Bahia.",
      "destaque": true,
      "obras": [
        {
          "id": 401,
          "titulo": "Capitães da Areia",
          "ano_publicacao": "1937",
          "img": "img/capitaes.jpg",
          "sinopse": "A história de um grupo de meninos de rua em Salvador que vivem de pequenos crimes, mas também de sonhos e solidariedade.",
          "personagens_principais": ["Pedro Bala", "Professor", "Sem-Pernas", "Volta Seca", "Dora"]
        },
        {
          "id": 402,
          "titulo": "Gabriela, Cravo e Canela",
          "ano_publicacao": "1958",
          "img": "img/gabriela.jpg",
          "sinopse": "Gabriela, uma mulher sensual e livre, transforma a vida de uma cidade marcada por coronelismo e tradições conservadoras.",
          "personagens_principais": ["Gabriela", "Nacib", "Tonico Bastos"]
        }
      ]
    },
    {
      "id": 5,
      "nome": "Manuel Bandeira",
      "nacionalidade": "Brasileiro",
      "data_nascimento": "19/04/1886",
      "genero_escrita": "Poesia modernista",
      "cidade_nascimento": "Recife",
      "estado_nascimento": "PE",
      "img": "img/bandeira.jpg",
      "biografia": "Poeta modernista que soube unir lirismo, simplicidade e profundidade, com temas como morte, infância e o cotidiano.",
      "destaque": true,
      "obras": [
        {
          "id": 501,
          "titulo": "Libertinagem",
          "ano_publicacao": "1930",
          "img": "img/libertinagem.jpg",
          "sinopse": "Coletânea de poemas que marca o auge do modernismo de Bandeira.",
          "personagens_principais": []
        },
        {
          "id": 502,
          "titulo": "Estrela da Vida Inteira",
          "ano_publicacao": "1966",
          "img": "img/estreladavida.jpg",
          "sinopse": "Antologia poética que reúne os principais poemas do autor.",
          "personagens_principais": []
        }
      ]
    },
    {
      "id": 6,
      "nome": "Mário de Andrade",
      "nacionalidade": "Brasileiro",
      "data_nascimento": "09/10/1893",
      "genero_escrita": "Modernismo, poesia, ensaio",
      "cidade_nascimento": "São Paulo",
      "estado_nascimento": "SP",
      "img": "img/mario.jpg",
      "destaque": true,
      "biografia": "Figura central do modernismo brasileiro, foi escritor, crítico, musicólogo e defensor da cultura nacional.",
      "obras": [
        {
          "id": 601,
          "titulo": "Macunaíma",
          "ano_publicacao": "1928",
          "img": "img/macunaima.jpg",
          "sinopse": "A saga do herói sem caráter que percorre o Brasil em busca de um amuleto mágico.",
          "personagens_principais": ["Macunaíma", "Maanape", "Jiguê"]
        },
        {
          "id": 602,
          "titulo": "Pauliceia Desvairada",
          "ano_publicacao": "1922",
          "img": "img/pauliceia.jpg",
          "sinopse": "Livro de poemas que inaugura o modernismo no Brasil, com versos livres e visão irreverente da cidade de São Paulo.",
          "personagens_principais": []
        }
      ]
    },
    {
      "id": 7,
      "nome": "Cecília Meireles",
      "nacionalidade": "Brasileira",
      "data_nascimento": "07/11/1901",
      "genero_escrita": "Poesia lírica e simbolista",
      "cidade_nascimento": "Rio de Janeiro",
      "estado_nascimento": "RJ",
      "img": "img/cecilia.jpg",
      "destaque": true,
      "biografia": "Poeta lírica e delicada, sua obra é marcada por musicalidade e reflexões sobre o tempo e a existência.",
      "obras": [
        {
          "id": 701,
          "titulo": "Romanceiro da Inconfidência",
          "ano_publicacao": "1953",
          "img": "img/romanceiro.jpg",
          "sinopse": "Poemas que narram os eventos da Inconfidência Mineira com lirismo e profundidade histórica.",
          "personagens_principais": ["Tiradentes", "Cláudio Manuel da Costa", "Tomás Antônio Gonzaga"]
        },
        {
          "id": 702,
          "titulo": "Viagem",
          "ano_publicacao": "1939",
          "img": "img/viagem.jpg",
          "sinopse": "Obra-prima com poemas que exploram o universo interior e a busca por transcendência.",
          "personagens_principais": []
        }
      ]
    },
    {
      "id": 8,
      "nome": "Carlos Drummond de Andrade",
      "nacionalidade": "Brasileiro",
      "data_nascimento": "31/10/1902",
      "genero_escrita": "Poesia modernista e existencialista",
      "cidade_nascimento": "Itabira",
      "estado_nascimento": "MG",
      "img": "img/drummond.jpg",
      "destaque": true,
      "biografia": "Um dos maiores poetas da língua portuguesa, sua obra mescla ironia, melancolia e crítica social.",
      "obras": [
        {
          "id": 801,
          "titulo": "Alguma Poesia",
          "ano_publicacao": "1930",
          "img": "img/alguma.jpg",
          "sinopse": "Primeiro livro de Drummond, traz o famoso poema 'No meio do caminho'.",
          "personagens_principais": []
        },
        {
          "id": 802,
          "titulo": "A Rosa do Povo",
          "ano_publicacao": "1945",
          "img": "img/rosa.jpg",
          "sinopse": "Poemas escritos durante a Segunda Guerra Mundial, com forte crítica social e engajamento político.",
          "personagens_principais": []
        }
      ]
    }
  ]
};

//JavaScript
//cards responsivos das obras
function carregaAutor() {
  const autoresContainer = document.getElementById("autoresContainer");
  if (!autoresContainer || !dadosLiterarios || !dadosLiterarios.autores) return;

  autoresContainer.innerHTML = "";

  for (let i = 0; i < dadosLiterarios.autores.length; i++) {
    const autor = dadosLiterarios.autores[i];
    const card = `
      <div class="col-6 col-sm-4 col-md-3 col-lg-2">
        <div class="card h-100 mb-4 shadow-sm">
          <img src="${autor.img}" class="card-img-top mx-auto d-block" alt="${autor.nome}" style="max-height: 150px; object-fit: cover;">
          <div class="card-body p-2">
            <h5 class="card-title text-center mb-2">${autor.nome}</h5>
            <div class="text-center mt-2">
              <a href="detalhes.html?id=${autor.id}" class="btn btn-primary btn-sm">Ver detalhes</a>
            </div>
          </div>
        </div>
      </div>
    `;
    autoresContainer.innerHTML += card;
  }
}

//cards responsivos das obras
function carregaObras() {
  const container = document.getElementById("obrasContainer");
  container.innerHTML = "";

  for (let i = 0; i < dadosLiterarios.autores.length; i++) {
    const autor = dadosLiterarios.autores[i];
    for (let j = 0; j < autor.obras.length; j++) {
      const obra = autor.obras[j];
      const card = `
        <div class="col-6 col-sm-4 col-md-3 col-lg-2">
          <div class="card h-100 mb-4 shadow-sm">
            <img src="${obra.img}" class="card-img-top mx-auto d-block" alt="${obra.titulo}" style="max-height: 150px; object-fit: cover;">
            <div class="card-body p-2">
              <h5 class="card-title text-center mb-2">${obra.titulo}</h5>
              <p class="text-center mb-2"><strong>Autor:</strong> ${autor.nome}</p>
              <div class="text-center mt-2">
                <a href="detalhes.html?id=${obra.id}" class="btn btn-primary btn-sm">Ver detalhes</a>
              </div>
            </div>
          </div>
        </div>
      `;
      container.innerHTML += card;
    }
  }
}

//mostra os detalhes do autor
function carregaDetalhes() {
  const container = document.getElementById("detalhesContainer");
  if (!container) return;
  container.innerHTML = "";

  const urlParams = new URLSearchParams(window.location.search);
  const id = parseInt(urlParams.get("id"));
  if (isNaN(id)) {
    container.innerHTML = "<p>ID inválido.</p>";
    return;
  }

  let autor = null;
  for (let i = 0; i < dadosLiterarios.autores.length; i++) {
    if (dadosLiterarios.autores[i].id === id) {
      autor = dadosLiterarios.autores[i];
      break;
    }
  }

  if (!autor) {
    container.innerHTML = "<p>Autor não encontrado.</p>";
    return;
  }

  let autorHTML = `
    <section class="autor-detalhes mb-5">
      <div class="row align-items-center">
        <div class="col-md-4 text-center">
          <img src="${autor.img}" alt="${autor.nome}" class="card-img-top mx-auto d-block">
        </div>
        <div class="col-md-8">
          <h2 class="fw-bold mb-3">${autor.nome}</h2>
          <p><strong>Data de nascimento:</strong> ${autor.data_nascimento}</p>
          <p><strong>Cidade natal:</strong> ${autor.cidade_nascimento} - ${autor.estado_nascimento}</p>
          <p><strong>Gênero de escrita:</strong> ${autor.genero_escrita}</p>
          <p><strong>Nacionalidade:</strong> ${autor.nacionalidade}</p>
          <p class="mt-3">${autor.biografia}</p>
        </div>
      </div>
    </section>
  `;

  let obrasHTML = "";
  for (let j = 0; j < autor.obras.length; j++) {
    const obra = autor.obras[j];
    obrasHTML += `
      <div class="col-6 col-sm-4 col-md-3 col-lg-2">
        <div class="card h-100 shadow-sm obra-card" onclick="abrirObra(${obra.id})">
          <img src="${obra.img}" class="card-img-top mx-auto d-block" alt="${obra.titulo}">
          <div class="card-body">
            <h5 class="card-title">${obra.titulo}</h5>
          </div>
        </div>
      </div>
    `;
  }

  const obrasSection = `
    <section>
      <h4 class="fw-semibold mb-3">Obras</h4>
      <div class="row">${obrasHTML}</div>
    </section>
  `;

  container.innerHTML = autorHTML + obrasSection + `
    <div class="text-start mt-4">
      <button class="btn btn-secondary" onclick="window.history.back()">Voltar</button>
    </div>
  `;
}

//abre a pagina de detalhes da obra
function abrirObra(id) {
  window.location.href = `detalhes.html?id=${id}`;
}

//mostra os detalhes da obra
function carregaDetalhesObra() {
  const container = document.getElementById("detalhesObraContainer");
  container.innerHTML = "";

  const urlParams = new URLSearchParams(window.location.search);
  const id = parseInt(urlParams.get("id"));

  let obraEncontrada = null;
  let autorEncontrado = null;

  for (let i = 0; i < dadosLiterarios.autores.length; i++) {
    const autor = dadosLiterarios.autores[i];
    for (let j = 0; j < autor.obras.length; j++) {
      const obra = autor.obras[j];
      if (obra.id === id) {
        obraEncontrada = obra;
        autorEncontrado = autor;
        break;
      }
    }
    if (obraEncontrada) break;
  }

  if (!obraEncontrada) {
    container.innerHTML = "<p>Obra não encontrada.</p>";
    return;
  }

  let personagensHTML = "";
  if (obraEncontrada.personagens_principais && obraEncontrada.personagens_principais.length > 0) {
    personagensHTML = `<p><strong>Personagens principais:</strong> ${obraEncontrada.personagens_principais.join(", ")}</p>`;
  }

  const obraHTML = `
    <section class="obra-detalhes mb-5">
      <div class="row align-items-center">
        <div class="col-md-4 text-center">
          <img src="${obraEncontrada.img}" alt="${obraEncontrada.titulo}" class="card-img-top mx-auto d-block">
        </div>
        <div class="col-md-8">
          <h2 class="fw-bold mb-3">${obraEncontrada.titulo}</h2>
          <p><strong>Autor:</strong> ${autorEncontrado.nome}</p>
          <p><strong>Ano de publicação:</strong> ${obraEncontrada.ano_publicacao}</p>
          ${personagensHTML}
          <p class="mt-3">${obraEncontrada.sinopse}</p>
        </div>
      </div>
    </section>
    <div class="text-start mt-4">
      <button class="btn btn-secondary" onclick="window.history.back()">Voltar</button>
    </div>
  `;

  container.innerHTML = obraHTML;
}

//verifica pelo id se se trata de um autor ou de uma obra
function verificaTipoID(id) {
  for (let i = 0; i < dadosLiterarios.autores.length; i++) {
    if (dadosLiterarios.autores[i].id === id) {
      return "autor";
    }
    for (let j = 0; j < dadosLiterarios.autores[i].obras.length; j++) {
      if (dadosLiterarios.autores[i].obras[j].id === id) {
        return "obra";
      }
    }
  }
  return "desconhecido";
}

//DOM pag. detalhes
document.addEventListener("DOMContentLoaded", function () {
  const id = parseInt(new URLSearchParams(window.location.search).get("id"));
  const type = verificaTipoID(id);
  const container = document.getElementById("detalhesContainer");

  if (type === "autor") {
    carregaDetalhes();
  } else if (type === "obra") {
    carregaDetalhesObra();
  } else {
    container.innerHTML = "<p>ID não encontrado.</p>";
  }
});


//carrosel destaque
function carregaAutoresDestaque() {
  const container = document.getElementById("carouselAutores");
  const indicadores = document.querySelector(".carousel-indicators");
  container.innerHTML = "";
  indicadores.innerHTML = "";

  const autoresDestaque = [];
  for (let i = 0; i < dadosLiterarios.autores.length; i++) {
    const autor = dadosLiterarios.autores[i];
    if (autor.destaque === true) {
      autoresDestaque.push(autor);
    }
  }

  for (let i = 0; i < autoresDestaque.length; i++) {
    const autor = autoresDestaque[i];
    let ativo = "";
    if (i === 0) {
      ativo = "active";
    } else {
      ativo = "";
    }

    const slide = `
      <div class="carousel-item ${ativo}">
        <div class="card card-destaque shadow-sm">
          <div class="row g-0 align-items-center">
            <div class="col-md-4 text-center d-flex justify-content-center align-items-center">
              <img src="${autor.img}" class="img-fluid rounded-start" alt="${autor.nome}" style="max-height: 350px; object-fit: cover;">
            </div>
            <div class="col-md-8 d-flex align-items-center">
              <div class="card-body bg-white p-2 rounded-end">
                <h5 class="card-title">${autor.nome}</h5>
                <p class="card-text">${autor.biografia}</p>
                <a href="detalhes.html?id=${autor.id}" class="btn btn-primary mt-2">Ver detalhes</a>
              </div>
            </div>
          </div>
        </div>
      </div>
    `;

    const indicador = `<button type="button" data-bs-target="#destaquesCarousel" data-bs-slide-to="${i}" class="${ativo}" aria-label="Slide ${i + 1}"></button>`;

    container.innerHTML += slide;
    indicadores.innerHTML += indicador;
  }
}